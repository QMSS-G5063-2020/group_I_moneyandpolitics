---
title: "lobby_indus"
author: "Sayali Nagwekar"
date: "05/05/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(devtools)
library(tidytext)
library(dplyr)
library(stringr)
library(tidyverse)
library(SnowballC)
library(tm)
library(wordcloud)
library(lsa)
library(ggplot2)
library(igraph)
```

```{r}
# Data Cleaning
lobby2 <- tibble(file = paste0(c("lob_indus.txt"))) %>%
        mutate(text = map(file, read_lines)) %>%
        unnest() %>%
        group_by(file = str_sub(basename(file), 1, -5)) %>% 
        mutate(line_number = row_number()) %>%
        ungroup() %>%
        unnest_tokens(word, text) %>% 
        anti_join(stop_words) %>% ## remove stop words 
        mutate(word = wordStem(word)) ## stemming the words
```

```{r}
# Bing sentiment analysis
lobby2_sentiment <- lobby2 %>%
        inner_join(get_sentiments("bing")) %>%
        count(word, sentiment, sort = TRUE) %>%
        ungroup()

lobby2_sentiment
```

```{r}
lobby2_sentiment %>%
        group_by(sentiment) %>%
        top_n(10) %>%
        ungroup() %>%
        mutate(word = reorder(word, n)) %>%
        ggplot(aes(word, n, fill = sentiment)) +
        geom_col(show.legend = FALSE) +
        facet_wrap(~sentiment, scales = "free_y") +
        labs(y = "Contribution to sentiment",
                x = NULL) +
        coord_flip()
```


```{r}
# NRC Sentiment Analysis - Disgust
nrc_disgust <- get_sentiments("nrc") %>% 
        filter(sentiment == "disgust")

sent2_disgust <- lobby2 %>%
        inner_join(nrc_disgust) %>%
        count(word, sort = TRUE)
sent2_disgust
```

```{r}
sent2_disgust %>%
        group_by(n) %>%
        top_n(10) %>%
        ungroup() %>%
        mutate(word = reorder(word, n)) %>%
        ggplot(aes(word, n, fill = n)) +
        geom_col(show.legend = FALSE) +
        facet_wrap(~n, scales = "free_y") +
        labs(y = "Contribution to sentiment",
                x = NULL) +
        coord_flip()
```

